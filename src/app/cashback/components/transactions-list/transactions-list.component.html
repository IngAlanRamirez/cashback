<div class="head-movements">
  <div class="title-section">
    <h3>{{ translate.t('transactions.movimientos') }}</h3>
    <p>{{ translate.t('transactions.montosEnMXN') }}</p>
  </div>
  @if (showFilter) {
    <button 
      class="btn-filter" 
      (click)="onFilterClick()"
      type="button"
      [attr.aria-label]="translate.t('transactions.filtrarMovimientos')"
      [attr.title]="translate.t('transactions.filtrarMovimientos')">
      <ion-icon name="options" aria-hidden="true"></ion-icon>
    </button>
  }
</div>

  @if (isCurrentPeriod()) {
  <div class="disclaimer-container" role="alert" aria-live="polite">
    <ion-icon name="warning" aria-hidden="true"></ion-icon>
    <span>{{ translate.t('transactions.disclaimer') }}</span>
  </div>
}

@if (purchases.length === 0) {
  <div class="empty-state">
    <p>{{ translate.t('transactions.noHayMovimientos') }}</p>
  </div>
} @else {
  <div class="movements-container">
    @for (purchase of purchases; track trackByPurchaseId($index, purchase)) {
      <app-transaction-item
        [description]="purchase.merchant.name || ''"
        [date]="purchase.orderDate"
        [amount]="purchase.amount.amount"
        [cashback_amount]="purchase.clearing.cashBackAmount.amount"
        [category]="purchase.merchant.categoryCode || ''">
      </app-transaction-item>
    }
  </div>
  
  @if (isLoading && purchases.length > 0) {
    <div class="loading-more-container">
      <ion-spinner name="crescent"></ion-spinner>
      <span>{{ translate.t('transactions.cargandoMas') }}</span>
    </div>
  } @else if (hasMorePages()) {
    <div class="btn-more-container">
      <button 
        class="btn-more"
        (click)="onLoadMore()"
        type="button"
        [attr.aria-label]="translate.t('common.verMas')">
        {{ translate.t('common.verMas') }}
      </button>
    </div>
  }
}

