<div class="head-movements">
  <div class="title-section">
    <h3>Movimientos</h3>
    <p>Montos en MXN</p>
  </div>
  @if (showFilter) {
    <button 
      class="btn-filter" 
      (click)="onFilterClick()"
      type="button"
      aria-label="Filtrar movimientos"
      title="Filtrar movimientos">
      <ion-icon name="options" aria-hidden="true"></ion-icon>
    </button>
  }
</div>

  @if (isCurrentPeriod()) {
  <div class="disclaimer-container" role="alert" aria-live="polite">
    <ion-icon name="warning" aria-hidden="true"></ion-icon>
    <span>Tus compras se reflejarán en 24 a 48 h hábiles.</span>
  </div>
}

@if (purchases.length === 0) {
  <div class="empty-state">
    <p>No hay movimientos disponibles</p>
  </div>
} @else {
  <div class="movements-container">
    @for (purchase of purchases; track trackByPurchaseId($index, purchase)) {
      <app-transaction-item
        [description]="purchase.merchant.name || ''"
        [date]="purchase.orderDate"
        [amount]="purchase.amount.amount"
        [cashback_amount]="purchase.clearing.cashBackAmount.amount"
        [category]="purchase.merchant.categoryCode || ''">
      </app-transaction-item>
    }
  </div>
  
  @if (isLoading && purchases.length > 0) {
    <div class="loading-more-container">
      <ion-spinner name="crescent"></ion-spinner>
      <span>Cargando más transacciones...</span>
    </div>
  } @else if (hasMorePages()) {
    <div class="btn-more-container">
      <button 
        class="btn-more"
        (click)="onLoadMore()"
        type="button"
        aria-label="Cargar más movimientos">
        Ver más
      </button>
    </div>
  }
}

